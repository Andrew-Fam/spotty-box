angular.module("ui.bootstrap",["ui.bootstrap.transition","ui.bootstrap.modal"]),angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function(n,e,t){function o(n){for(var e in n)if(void 0!==r.style[e])return n[e]}var a=function(o,r,i){i=i||{};var c=n.defer(),l=a[i.animation?"animationEndEventName":"transitionEndEventName"],s=function(){t.$apply(function(){o.unbind(l,s),c.resolve(o)})};return l&&o.bind(l,s),e(function(){angular.isString(r)?o.addClass(r):angular.isFunction(r)?r(o):angular.isObject(r)&&o.css(r),l||c.resolve(o)}),c.promise.cancel=function(){l&&o.unbind(l,s),c.reject("Transition cancelled")},c.promise},r=document.createElement("trans"),i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},c={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return a.transitionEndEventName=o(i),a.animationEndEventName=o(c),a}]),angular.module("ui.bootstrap.modal",["ui.bootstrap.transition"]).factory("$$stackedMap",function(){return{createNew:function(){var n=[];return{add:function(e,t){n.push({key:e,value:t})},get:function(e){for(var t=0;t<n.length;t++)if(e==n[t].key)return n[t]},keys:function(){for(var e=[],t=0;t<n.length;t++)e.push(n[t].key);return e},top:function(){return n[n.length-1]},remove:function(e){for(var t=-1,o=0;o<n.length;o++)if(e==n[o].key){t=o;break}return n.splice(t,1)[0]},removeTop:function(){return n.splice(n.length-1,1)[0]},length:function(){return n.length}}}}}).directive("modalBackdrop",["$timeout",function(n){return{restrict:"EA",replace:!0,templateUrl:"template/modal/backdrop.html",link:function(e){e.animate=!1,n(function(){e.animate=!0})}}}]).directive("modalWindow",["$modalStack","$timeout",function(n,e){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:"template/modal/window.html",link:function(t,o,a){t.windowClass=a.windowClass||"",e(function(){t.animate=!0,o[0].focus()}),t.close=function(e){var t=n.getTop();t&&t.value.backdrop&&"static"!=t.value.backdrop&&e.target===e.currentTarget&&(e.preventDefault(),e.stopPropagation(),n.dismiss(t.key,"backdrop click"))}}}}]).factory("$modalStack",["$transition","$timeout","$document","$compile","$rootScope","$$stackedMap",function(n,e,t,o,a,r){function i(){for(var n=-1,e=f.keys(),t=0;t<e.length;t++)f.get(e[t]).value.backdrop&&(n=t);return n}function c(n){var e=t.find("body").eq(0),o=f.get(n).value;f.remove(n),s(o.modalDomEl,o.modalScope,300,l),e.toggleClass(p,f.length()>0)}function l(){if(d&&-1==i()){var n=u;s(d,u,150,function(){n.$destroy(),n=null}),d=void 0,u=void 0}}function s(t,o,a,r){function i(){i.done||(i.done=!0,t.remove(),r&&r())}o.animate=!1;var c=n.transitionEndEventName;if(c){var l=e(i,a);t.bind(c,function(){e.cancel(l),i(),o.$apply()})}else e(i,0)}var d,u,p="modal-open",f=r.createNew(),m={};return a.$watch(i,function(n){u&&(u.index=n)}),t.bind("keydown",function(n){var e;27===n.which&&(e=f.top(),e&&e.value.keyboard&&a.$apply(function(){m.dismiss(e.key)}))}),m.open=function(n,e){f.add(n,{deferred:e.deferred,modalScope:e.scope,backdrop:e.backdrop,keyboard:e.keyboard});var r=t.find("body").eq(0),c=i();c>=0&&!d&&(u=a.$new(!0),u.index=c,d=o("<div modal-backdrop></div>")(u),r.append(d));var l=angular.element("<div modal-window></div>");l.attr("window-class",e.windowClass),l.attr("index",f.length()-1),l.attr("animate","animate"),l.html(e.content);var s=o(l)(e.scope);f.top().value.modalDomEl=s,r.append(s),r.addClass(p)},m.close=function(n,e){var t=f.get(n).value;t&&(t.deferred.resolve(e),c(n))},m.dismiss=function(n,e){var t=f.get(n).value;t&&(t.deferred.reject(e),c(n))},m.dismissAll=function(n){for(var e=this.getTop();e;)this.dismiss(e.key,n),e=this.getTop()},m.getTop=function(){return f.top()},m}]).provider("$modal",function(){var n={options:{backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function(e,t,o,a,r,i,c){function l(n){return n.template?o.when(n.template):a.get(n.templateUrl,{cache:r}).then(function(n){return n.data})}function s(n){var t=[];return angular.forEach(n,function(n){(angular.isFunction(n)||angular.isArray(n))&&t.push(o.when(e.invoke(n)))}),t}var d={};return d.open=function(e){var a=o.defer(),r=o.defer(),d={result:a.promise,opened:r.promise,close:function(n){c.close(d,n)},dismiss:function(n){c.dismiss(d,n)}};if(e=angular.extend({},n.options,e),e.resolve=e.resolve||{},!e.template&&!e.templateUrl)throw new Error("One of template or templateUrl options is required.");var u=o.all([l(e)].concat(s(e.resolve)));return u.then(function(n){var o=(e.scope||t).$new();o.$close=d.close,o.$dismiss=d.dismiss;var r,l={},s=1;e.controller&&(l.$scope=o,l.$modalInstance=d,angular.forEach(e.resolve,function(e,t){l[t]=n[s++]}),r=i(e.controller,l)),c.open(d,{scope:o,deferred:a,content:n[0],backdrop:e.backdrop,keyboard:e.keyboard,windowClass:e.windowClass})},function(n){a.reject(n)}),u.then(function(){r.resolve(!0)},function(){r.reject(!1)}),d},d}]};return n});